# metastaar_notebook_terra
Notebook scripts for rare variants meta-analysis of WGS data in Biodata Catalyst Terra using MetaSTAAR.
## Description
These are the notebook scripts in R for performing rare variants meta-analysis of WGS data based on the Meta-analysis of variant-Set Test for Association using Annotation infoRmation (MetaSTAAR) method, including (1) generating rare variant summary statistics and (2) performing rare variant meta-analysis.   
## Usage
Container image: zilinli/metastaar_dockerimage_terra_notebook.
### TOPMed genotype data
Please send an email to li@hsph.harvard.edu for the access of aGDS files in Terra. TOPMed Freeze 5 aGDS files are in the workspace "MetaSTAAR_Lipids_F8", and TOPMed Freeze 8 aGDS files are in the workspace "topmed_agds".
### Notebook scripts
MetaSTAAR_Worker_Cov_Generation.R and MetaSTAAR_Wroker_Score_Generation.R are the notebook scripts for generating rare variants summary statistics based on MetaSTAARWorker. Specifically, MetaSTAAR_Worker_Cov_Generation.R is used to generate the sparse weighted linkage disequilibrium (LD) matrices among rare variants. MetaSTAAR_Wroker_Score_Generation.R is used to generate individual variant summary statistics of all variants (both common and rare) across the genome. 

MetaSTAAR_RVAT_Sliding_Window.R are the notebook scripts for performing rare variant meta-analysis based on the summary statistics generated by MetaSTAARWorker. Specifically, MetaSTAAR_RVAT_Sliding_Window.R is used to perform sliding window analysis across the genome.

## Computation Cost
MetaSTAARWorker_Estimated_Cost.pdf is the benchmarked cost of MetaSTAARWorker.
